!function(){"use strict";window.angular.module("msGantt",["gantt"]);var a={"GridColumnFilter.SortAscending":"Sort A - Z","GridColumnFilter.SortDescending":"Sort Z - A","GridColumnFilter.FilterLabel":"Filter","GridColumnFilter.LinkSelectAll":"Select all","GridColumnFilter.LinkClear":"Clear","GridColumnFilter.SearchInput":"Search...","GridColumnFilter.ButtonSubmit":"OK","GridColumnFilter.ButtonCancel":"Cancel"},b=window.angular.module("ms.common.controls",["pascalprecht.translate","msGantt"]);b.config(["$translateProvider",function(b){b.translations("en",a),b.useStaticFilesLoader({prefix:"languages/",suffix:".json"}),b.preferredLanguage("en")}]);var c={events:{columnFilters:"ms-cc:columnFilterApplied"}};b.constant("msConstants",c)}(),function(a){"use strict";a.factory("msCommonService",function(){function a(a,b){var c=b.split(".");if(c.length<=1)return a[b];for(var d=a,e=0;e<c.length&&(d=d[c[e]],d);e++);return d}return{getDeepValue:a}})}(angular.module("ms.common.controls")),function(a){"use strict";a.controller("filterByColumnController",["$scope","$filter","msConstants",function(a,b,c){function d(a,b){if(b){var c=[];return _.each(a,function(a){c.push(b({item:a}))}),c}return a}function e(){i.filters=angular.copy(i.filtersInitialState),delete i.filtersInitialState}function f(b){a.tableSource.columnFilters=a.tableSource.columnFilters||{},a.tableSource.columnFilters.appliedFilters=a.tableSource.columnFilters.appliedFilters||[],a.tableSource.columnFilters.appliedFilters.length>0&&(a.tableSource.columnFilters.appliedFilters=_.reject(a.tableSource.columnFilters.appliedFilters,function(a){return b.filterBy==a.filterBy})),a.transformFunction&&(b.transformFunction=a.transformFunction),a.tableSource.columnFilters.appliedFilters.push(b)}function g(){a.tableSource.columnFilters&&a.tableSource.columnFilters.appliedFilters&&(a.tableSource.columnFilters.appliedFilters.length=0),_.each(a.tableSource,function(a){a.omit=!1})}function h(a,b){var c=b.split(".");if(c.length<=1)return a[b];for(var d=a,e=0;e<c.length&&(d=d[c[e]],d);e++);return d}var i;a.status={isOpen:!1,filteringCanceled:!1},a.prepareFilterByColumn=function(b){a.allowPropagation=!1,a.filterText=null,i&&i.hasOwnProperty("filters")||(i={filters:[]}),i.filtersInitialState&&e();var c=_.find(i.filters,function(a){return a.filterBy==b});i.activeFilter=b,c||i.filters.push({filterBy:b,values:[]}),i.filtersInitialState=angular.copy(i.filters);var f=_.map(a.tableSource,function(a){return h(a,b)});f=d(f,a.transformFunction);var g=_.unique(f,function(a){return a});g=_.sortBy(g,function(a){return a}),a.filterableItems=[];for(var j=_.find(i.filters,function(a){return a.filterBy==b}),k=0;k<g.length;k++)a.filterableItems.push({name:g[k],checked:_.contains(j.values,g[k])})},a.cancelColumnFilterSelection=function(){a.allowPropagation=!0,a.status.filteringCanceled=!0,e()},a.applyColumnFilters=function(b){function d(a,b){return _.find(a,function(a){return!_.contains(b,a)})}a.allowPropagation=!0;var e=i.activeFilter,g=_.find(i.filters,function(a){return a.filterBy==e});if(a.$emit(c.events.columnFilters,{filteredBy:i.activeFilter}),b||!i.filtersInitialState||g.values.length!=i.filtersInitialState[0].values.length||d(g.values,i.filtersInitialState[0].values)){f(g);var j=a.tableSource.columnFilters.appliedFilters;_.each(a.tableSource,function(a){a.omit=!1});for(var k=0;k<j.length;k++){var l=j[k].filterBy,m=_.filter(a.tableSource,function(a){return 0==k||!a.omit});_.each(m,function(a){a.omit=!1}),j[k].values.length>0&&_.each(m,function(a){var b=h(a,l),c=j[k].transformFunction?j[k].transformFunction({item:b}):b;_.contains(j[k].values,c)||(a.omit=!0)})}delete i.filtersInitialState}},a.addAllColumnFilters=function(){var c=_.find(i.filters,function(a){return a.filterBy==i.activeFilter});if(c){var d=b("filter")(a.filterableItems,a.filterText);_.each(d,function(a){a.checked=!0,c.values.push(a.name)})}},a.clearAllColumnFilters=function(){var b=_.find(i.filters,function(a){return a.filterBy==i.activeFilter});b&&(_.each(a.filterableItems,function(a){a.checked=!1}),b.values.length=0)},a.addColumnFilter=function(a){a.checked=!a.checked;var b=_.find(i.filters,function(a){return a.filterBy==i.activeFilter});if(a.checked)b.values.push(a.name);else for(var c=0;c<b.values.length;c++)if(b.values[c]===a.name){b.values.splice(c,1);break}},a.isFilteredBy=function(a){if(i&&i.filters){var b=_.find(i.filters,function(b){return b.filterBy===a});return b&&b.values.length>0}return!1},a.sort=function(c,d){var e=b("orderBy")(a.tableSource,c,d);a.tableSource.length=0,_.each(e,function(b){a.tableSource.push(b)})},a.applyOutsideFiltering=function(b){if(b.checked||!a.customFiltering||!i||!i.activeFilter)return!0;var c=_.filter(a.tableSource,function(c){var d=h(c,i.activeFilter),e=a.transformFunction?a.transformFunction({item:d}):d;return e==b.name});if(0==c.length)return!1;for(var d=!1,e=0;e<c.length&&!(d=a.customFiltering({tableItem:c[e]}));e++);return d},a.$watch("clearFilters",function(){a.clearFilters&&(i={},a.clearFilters=!1,g())},!1),a.$watch("tableSource",function(b,c){if(b&&c&&i&&i.activeFilter){for(var d,e=0;e<a.tableSource.columnFilters.appliedFilters.length;e++){var f=a.tableSource.columnFilters.appliedFilters[e].filterBy,g=f.split("."),h=b,j=c;if(_.each(g,function(a){h=_.pluck(h,a),j=_.pluck(j,a)}),d=JSON.stringify(h)!=JSON.stringify(j))break}d&&a.applyColumnFilters(!0)}},!0),a.$watch("status.isOpen",function(b){var c=a.status.filteringCanceled;b||c||i&&i.activeFilter&&a.applyColumnFilters(!1),c&&(a.status.filteringCanceled=!1)},!1)}])}(angular.module("ms.common.controls")),function(a){"use strict";a.directive("msFilterByColumn",["$http","$templateCache","$compile",function(a,b,c){return{restrict:"A",scope:{tableSource:"=",clearFilters:"=",transformFunction:"&",customFiltering:"&"},controller:"filterByColumnController",link:function(d,e,f){a.get("templates/ms-controls/filterByColumn.html",{cache:b}).success(function(a){a=a.replace(/FILTER_TYPE_PLACEHOLDER/g,f.msFilterByColumn);var b=e.html().trim();a+=b,e.empty(),e.append(c(a)(d)),f.transformFunction||(d.transformFunction=void 0),f.customFiltering||(d.customFiltering=void 0)})}}}])}(angular.module("ms.common.controls")),function(a){"use strict";a.directive("stopEvent",[function(){return{restrict:"A",link:function(a,b,c){b.bind(c.stopEvent,function(b){a.allowPropagation||b.stopPropagation(),a.allowPropagation=!1})}}}])}(angular.module("ms.common.controls")),function(a){"use strict";a.directive("ganttCurrentDate",["$window","$timeout",function(a,b){return{require:"gantt",link:function(a,c){b(function(){var d,e=c.children();_.each(e,function(c){var e=angular.element(c);if(e.hasClass("gantt-scrollable"))e.bind("scroll",function(){angular.element(d).css("left",e.scope().ganttScroll[0].scrollLeft+"px"),b(function(){a.calender.focusedDate=angular.element(d).scope().c.date},200)});else if(e.hasClass("gantt-head")){var f=angular.element(e.children()[0]);_.each(f,function(b){var c=angular.element(b).children()[0],f=angular.element(c).children();d=f[0],angular.element(d).css("left",e.scope().ganttScroll[0].scrollLeft+"px"),a.calender.focusedDate=angular.element(d).scope().c.date})}})},500)}}}])}(angular.module("msGantt")),function(a){"use strict";a.directive("ganttHighlightTask",["$timeout",function(a){return{link:function(b,c){b.$watch("ganttHighlightTask.id",function(d){d&&a(function(){var e="#gantt-task-"+d,f=angular.element(c[0].querySelector(e));f.addClass("pulsor"),b.ganttHighlightTask.id=void 0,a(function(){f.removeClass("pulsor")},5e3)},500)})}}}])}(angular.module("msGantt")),function(a){"use strict";a.directive("ganttVerticalLine",["$timeout",function(a){return{replace:!0,scope:{interval:"@"},templateUrl:"../app/templates/ms-controls/gantt/verticalLineTemplate.html",link:function(b){function c(){var d=new Date;b.verticalLine={hours:d.getHours(),minutes:d.getMinutes()},a(c,b.interval)}b.interval=b.interval||6e4,c()}}}])}(angular.module("msGantt")),function(a){"use strict";a.controller("tagsController",["$scope",function(a){a.selectedTags=[],a.isDeleteIconVisible=!1,a.alldefaultTags=angular.copy(a.defaultTags),a.addNewTag=function(){var b={id:a.selectedTags.length+1,name:a.insertedTag};a.doubleInput=!1,angular.forEach(a.selectedTags,function(b){b.name==a.insertedTag&&(a.doubleInput=!0,a.insertedTag="")}),!a.doubleInput&&a.insertedTag&&(a.selectedTags.push(b),a.insertedTag="")},a.addTagFromDefaultTags=function(b,c,d){b.preventDefault();var e=d;a.defaultTags&&a.defaultTags.length>e&&a.defaultTags.splice(e,1),a.isDeleteIconVisible=!0,a.selectedTags.push(c)},a.removeSelectedFeature=function(b){var c=a.tagsCollection.indexOf(b);a.tagsCollection.splice(c,1)},a.remove=function(b,c){var d=c;angular.forEach(a.alldefaultTags,function(c){if(b.name==c.name){var e=_.find(a.defaultTags,function(a){return a.name==c.name});e?a.selectedTags.splice(d,1):a.defaultTags.push(b)}}),a.selectedTags.splice(d,1)},a.clear=function(){angular.forEach(a.selectedTags,function(b){a.selectedTags.splice(b),a.defaultTags=angular.copy(a.alldefaultTags)})},a.removeAllSelectedItems=function(){a.tagsCollection=[]}}])}(angular.module("ms.common.controls")),function(a){"use strict";a.directive("msTags",function(){return{restrict:"A",replace:!0,controller:"tagsController",scope:{tagsCollection:"=msTags",enableCustomTags:"@",defaultTags:"="},link:function(a,b,c){a.isCustomTagEnabled="true"==c.enableCustomTags,a.getTemplateUrl=c.defaultTags?function(){return"templates/ms-controls/addTag.html"}:function(){return"templates/ms-controls/addFeature.html"}},template:'<div data-ng-include="getTemplateUrl()"> </div>'}})}(angular.module("ms.common.controls")),function(a){"use strict";a.controller("typeAheadDropDownController",["$scope","$timeout","msCommonService",function(a,b,c){function d(a,b,c){for(var d=b.length-1,e=0;d>e;++e){var f=b[e];f in a||(a[f]={}),a=a[f]}a[b[d]]=c||""}a.filterText={},a.status={isopen:!1},a.resetFiltering=function(){a.typeAheadModel="",a.status.isopen=!0,b(function(){a.activeIdx=0},0)},a.getIndexOfListItem=function(b){return a.idOfSelectedItem=b,b},a.toggleDropdown=function(b){b.preventDefault(),b.stopPropagation(),a.activeIdx=0,a.status.isopen=!a.status.isopen},a.selectChoice=function(b){var d=_.find(a.ngModel,function(a){return a==b});b&&!d&&a.enableMultipleSelection?a.ngModel.push(b):a.enableMultipleSelection||(a.ngModel=[],a.ngModel.push(b),a.typeAheadModel=c.getDeepValue(a.ngModel[0],a.typeAheadLabel)),a.status.isopen=!a.status.isopen},a.$watch("typeAheadModel",function(b){var e=_.find(a.dropDownItems,function(d){return c.getDeepValue(d,a.typeAheadLabel)==b});e||a.enableMultipleSelection||(a.ngModel=[]);var f=a.typeAheadLabel.split("."),g={};d(g,f,a.typeAheadModel),a.filterText=g,a.ngModel.length&&(a.filterText={})}),a.$watch("typeAheadModel.length",function(b){(b&&0==a.ngModel.length||a.ngModel.length&&a.enableMultipleSelection)&&(a.activeIdx=0,a.status.isopen=!0)}),a.focused=function(){a.isInputFocused=!0},a.blurred=function(){a.isInputFocused=!1}}])}(angular.module("ms.common.controls")),function(a){"use strict";a.directive("msTypeAheadDropDown",["$timeout","$parse","$compile","msCommonService",function(a,b,c,d){return{restrict:"A",replace:!0,require:"?ngModel",scope:{ngModel:"=",dropDownItems:"=msTypeAheadDropDown",enableMultipleSelectionParam:"@enableMultipleSelection",msRequiredName:"@"},controller:"typeAheadDropDownController",templateUrl:"templates/ms-controls/typeAheadDropDown.html",link:function(e,f,g,h){function i(){e.ngModel&&e.msRequiredName&&h.$setValidity("required",e.ngModel.length>0)}function j(){if(e.indexesOfVisitedItems.push(e.activeIdx),0==e.activeIdx)e.indexesOfVisitedItems=[],s.scrollTop=0,e.activeIdx++,e.indexesOfVisitedItems.push(e.activeIdx);else if(e.activeIdx>=e.filtered.length-1)e.indexesOfVisitedItems=[],s.scrollTop=0,e.activeIdx=0,e.indexesOfVisitedItems.push(e.activeIdx);else if(e.indexesOfVisitedItems.length){var a=_.find(e.indexesOfVisitedItems,function(a){return a>o});if(a){var b=_.last(e.indexesOfVisitedItems);b>o&&b+1>=o?(e.activeIdx++,s.scrollTop=s.scrollTop+r.singleItemHeight):0==s.scrollTop?e.activeIdx++:(s.scrollTop=s.scrollTop+r.singleItemHeight,e.activeIdx++)}else s.scrollTop=0,e.activeIdx++}}function k(){if(e.indexesOfVisitedItems.push(e.activeIdx),-1==e.activeIdx)e.activeIdx=0;else if(0==e.activeIdx)e.indexesOfVisitedItems=[],s.scrollTop=s.scrollHeight,e.activeIdx=e.filtered.length-1,e.indexesOfVisitedItems.push(e.activeIdx);else if(e.activeIdx==e.filtered.length-1)e.indexesOfVisitedItems=[],s.scrollTop=s.scrollHeight,e.activeIdx--,e.indexesOfVisitedItems.push(e.activeIdx);else if(e.indexesOfVisitedItems.length){var a=_.find(e.indexesOfVisitedItems,function(a){return a<e.filtered.length-1-o});if(a){var b=_.last(e.indexesOfVisitedItems);b>=e.filtered.length-1-o&&b+1>e.filtered.length-1-o?s.scrollTop!=r.totalHeight?(e.activeIdx--,s.scrollTop=s.scrollTop-r.singleItemHeight):e.activeIdx--:(e.activeIdx--,s.scrollTop=s.scrollTop-r.singleItemHeight)}else s.scrollTop=s.scrollHeight,e.activeIdx--}e.$apply()}function l(){e.selectedItem=e.filtered[e.activeIdx],e.selectChoice(e.selectedItem),s.scrollTop=0,e.activeIdx=-1}function m(){s.scrollTop=0,e.activeIdx=-1}function n(){a(function(){var a=t[0].offsetWidth,b=a,c=angular.element(s).find("li");_.each(c,function(a){var c=angular.element(a).find("div");if(c&&c[0]){var d=c[0].offsetWidth+30;b=d>b?d:b}}),_.each(c,function(c){var d=angular.element(c).find("a");b!=a?d.css("width",b-2):d.removeAttr("style")})},0)}h.$parsers.unshift(i),h.$formatters.unshift(i);var o=5,p=3,q={tabKey:9,enterKey:13,escKey:27,upKey:38,downKey:40},r={totalHeight:358,singleItemHeight:24};e.typeAheadLabel=g.typeAheadLabel||"",e.activeIdx=0,e.indexesOfVisitedItems=[],e.ngModel=e.ngModel||[],e.isInputFocused=!1,e.enableMultipleSelection=b(e.enableMultipleSelectionParam)();var s=f.find("ul")[0],t=f.find("input");e.msRequiredName&&(t.attr("name",e.msRequiredName),t.attr("required","required"),c(t)(e)),g.tabindex&&(t.attr("tabindex",g.tabindex),f.removeAttr("tabindex")),e.$watchCollection("filtered",function(){e.filtered&&e.dropDownItems&&e.filtered.length!=e.dropDownItems.length&&(e.activeIdx=0),e.filtered&&e.filtered.length>0&&n()}),t.bind("focus",function(){a(function(){if(s.scrollTop=0,e.ngModel.length){var b=e.dropDownItems.map(function(a,b){var c=e.typeAheadLabel;return a[c]==e.ngModel[0][c]?b:void 0}).filter(isFinite);e.activeIdx=b[0],a(function(){s.scrollTop=e.activeIdx>p?(e.activeIdx-p)*r.singleItemHeight:0},0)}else e.activeIdx=0;e.status.isopen=!0},200)}),f.bind("mouseover",function(){e.$apply(function(){e.activeIdx=e.getIndexOfListItem(e.idOfSelectedItem)})}),f.bind("keydown",function(a){if(0!==e.dropDownItems.length&&0!==e.filtered.length&&_.contains(_.values(q),a.which))switch(e.status.isopen=!0,a.which){case q.downKey:a.preventDefault(),e.$apply(j());break;case q.upKey:a.preventDefault(),e.$apply(k());break;case q.enterKey:a.preventDefault(),e.$apply(l());break;case q.tabKey:e.$apply(l());break;case q.escKey:a.preventDefault(),e.$apply(m());break;default:console.warn("Unknown key event!")}}),e.$watch("ngModel",function(a){if(i(),!e.enableMultipleSelection)if(a&&a[0]){var b=d.getDeepValue(a[0],e.typeAheadLabel);e.typeAheadModel=b}else e.isInputFocused||(e.typeAheadModel="")},!0),e.$watch("status.isopen",function(a){a&&n()})}}}]),a.directive("msOnCloseFocusInput",["$timeout",function(a){return{link:function(b,c){c.bind("click",function(){a(function(){var a=c.parent().find("input");a[0].focus()},100)})}}}])}(angular.module("ms.common.controls")),function(a){"use strict";a.filter("typeAheadLabel",["msCommonService",function(a){return function(b,c){return c?a.getDeepValue(b,c):b}}])}(angular.module("ms.common.controls"));